/* */ 
"format cjs";
!function(a,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):a.PchVideoPlayer=e()}(this,function(){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e=function(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")},t=function(){function a(a,e){for(var t=0;t<e.length;t++){var s=e[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(a,s.key,s)}}return function(e,t,s){return t&&a(e.prototype,t),s&&a(e,s),e}}(),s=function(a,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(a,e):a.__proto__=e)},i=function(a,e){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?a:e},r=function(){function a(){e(this,a),this.eventStack=[],this.firedStack=[]}return t(a,[{key:"on",value:function(a,e){var t=this;return"string"==typeof a&&(a.split(" ").filter(function(a){return""!=a}).forEach(function(a){"function"==typeof e&&(t.eventStack[a]=t.eventStack[a]||[],t.eventStack[a].push(e))}),!0)}},{key:"off",value:function(a){void 0===a?this.eventStack=[]:this.eventStack.splice(this.eventStack.indexOf(a),1)}},{key:"dispatchEvent",value:function(a){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.eventStack[a]||[];s.length&&(this.firedStack[a]=!0,s.forEach(function(a){a.call(e,t)}))}},{key:"dispatchOnce",value:function(a,e){return void 0===this.firedStack[a]&&(this.dispatchEvent(a,e),!0)}}]),a}(),n=function(a){function n(){return e(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this))}return s(n,r),t(n,[{key:"attachEvents",value:function(){var a=this;this.player.on("adStart",function(e){a.dispatchOnce("adStart",e)}),this.player.on("adBlocker",function(e){a.dispatchOnce("adBlocker",e)}),this.player.on("adImpression",function(e){a.debugMessage(a.messages.adImpression+a.primary+" Tag"),a.adImpression=!0,a.dispatchOnce("adImpression",e)}),this.player.on("adSkipped",function(e){a.dispatchOnce("adSkipped",e)}),this.player.on("adTime",function(e){var t=Math.round(e.duration-e.position);a.dispatchOnce("adTime",t)}),this.player.on("adClick",function(e){a.dispatchOnce("adClick",e)}),this.player.on("adError",function(e){a.ADError(e)}),this.player.on("adComplete",function(e){a.completeFlag=!0,a.debugMessage(a.messages.adComplete),a.dispatchEvent("adComplete",e)}),this.player.on("complete",function(){if(1!=a.adImpression)if(0!=a.adImpression||0!=a.fallBackEnabled){if(0==a.adImpression){if(0==a.fallBackFlag){if(a.fallBackFlag=!0,a.fallBackTime=Date.now(),a.HTMLFirst){if(a.detectFlash(),0==a.isFlashEnabled)return void a.dispatchEvent("noAd");a.flashFallBack()}else a.html5fallback();return}return a.noAd=!0,void a.dispatchEvent("noAd")}}else a.dispatchEvent("noAd");else 1!=a.completeFlag&&(a.debugMessage(a.messages.forceAdComplete),a.dispatchEvent("adComplete","forceComplete"))})}}]),n}(),o=function(){for(var a=!1,e=window.navigator.plugins,t=0;t<e.length;t++)/flash/i.test(e[t].name)&&(a=!0);return a},l={adImpression:"ad impression on ",adComplete:"adComplete",fallBacktoFlash:"flash fallback",htmlFallBack:"HTML5 fallback",noAD:" noAD",forceAdComplete:"force AD Complete",setupParams:" the setup parameters",flashDetected:" flash player detected",flashNotDetected:"flash player not detected",jwplayerScriptError:" JW player script is not available",containerError:"DOM container not found Error",adError:" AD Error ",playContent:"playing content ",fallbackToVideo:"fallback to video"},h=function(a){if(""==a||"string"!=typeof a)return"";var e=a;if(e=e.replace("[referrer_url]",encodeURIComponent(window.location.href)),e=e.replace("[description_url]",encodeURIComponent(window.location.href)),e=e.replace("[timestamp]",Date.now()),void 0!==window.PCHUSER){var t={};t.a=PCHUSER.age||"",t.g=""!=PCHUSER.gender?"m"==PCHUSER.gender||"1"==PCHUSER.gender?"1":"2":"",t.ar=PCHUSER.ageRange||"",t.seg=PCHUSER.segments||"",t.gmt=PCHUSER.gmt||"",t.level=PCHUSER.level||"",t.reglist=PCHUSER.reglist.join()||"";var s="";s="a="+t.a+"&g="+t.g+"&seg="+t.seg+"&gmt="+t.gmt+"&level="+t.level+"&reglist="+t.reglist,e+="&cust_params="+encodeURIComponent(s)}return e},c={flashFallBack:function(){var a=this;this.primary="flash",this.debugMessage(this.messages.fallBacktoFlash),this.selectVastTag(),this.params.advertising&&(this.params.advertising.tag=this.Adtag),this.debugMessage(this.messages.setupParams),this.setupPlayerParams(this.params),jwplayer().on("ready",function(){a.attachEvents(),a.dispatchEvent("fallbackComplete","flash")})},html5fallback:function(){var a=this;this.primary="html5",this.debugMessage(this.messages.htmlFallBack),this.selectVastTag(),this.params.advertising&&(this.params.advertising.tag=this.Adtag),this.debugMessage(this.params),this.setupPlayerParams(this.params),jwplayer().on("ready",function(){a.attachEvents(),a.dispatchEvent("fallbackComplete","HTML5")})},videoFallback:function(){}},d={ADError:function(a){this.debugMessage("error on AD "),this.debugMessage(a),this.dispatchOnce("adError",a)},debugMessage:function(a){0!=this.debugMode&&console.log("PCH Video Message >>>> ",a)},errorHandler:function(a){this.errorFlag=!0,console.log(a)}};return function(r){function p(a){e(this,p);var t=i(this,(p.__proto__||Object.getPrototypeOf(p)).call(this));return t.messages=l,t.eventStack=[],t.firedStack=[],t.noAd=!1,t.fallBackFlag=!1,t.completeFlag=!1,t.fallBackTime=null,t.flashAdEmtpy=!1,t.isFlashEnabled=!1,t.htmlADEmpty=!1,t.errorFlag=!1,t.params=a,t.container=t.params.container,t.AdTagsObj=t.params.adTags,t.primary=window.jwplayer.defaults.primary||"html5",t.fallBackEnabled="flash"===window.jwplayer.defaults.primary,t.client=t.params.adPlugin||"googima",t.Adtag=null,t.fallBackVideo=t.params.fallBackVideo||"",t.adImpression=!1,t.vpaidMode=t.params.vpaidmode||"insecure",t.updateDFPtag=t.params.updateTag||!1,t.adTech={firstTag:"flash",secondTag:"html5"},t.HTMLFirst=t.params.htmlFirst||!1,t.hasFlashTag=!0,t.mute=!0,t.device=t.params.device.toLowerCase()||"mobile",!1!==t.HTMLFirst&&(t.adTech={firstTag:"html5",secondTag:"flash"}),t.debugMode=!(!t.params.debugMode&&!/pchvideodebug=1|.qa.|.stg.|.dev./i.test(window.location.href)),t.params.adTags&&"string"!=typeof t.params.adTags.flashTag&&(t.params.adTags.flashTag=""),t.params.adTags&&"string"!=typeof t.params.adTags.html5Tag&&(t.params.adTags.html5Tag=""),t.hasFlashTag=""!==t.AdTagsObj.flashTag,"flash"!=t.primary||t.hasFlashTag||(t.primary,t.fallBackEnabled=!1),t.updateDFPtag&&(t.hasFlashTag&&(t.params.adTags.flashTag=h(t.params.adTags.flashTag)),t.params.adTags.html5Tag=h(t.params.adTags.html5Tag)),t.setInitialState(),"flash"===t.primary&&0==t.HTMLFirst&&t.detectFlash(),1==t.HTMLFirst&&(t.primary="html5"),t.selectVastTag(),t.setupPlayerParams(t.params),jwplayer().on("ready",function(){t.attachEvents()}),t}return s(p,n),t(p,[{key:"setInitialState",value:function(){null===document.getElementById(this.container)&&this.errorHandler(this.messages.containerError),window.jwplayer?this.player=window.jwplayer(this.container):this.errorHandler(this.messages.jwplayerScriptError),this.primary="desktop"==this.device?this.primary:"html5",this.mute="desktop"!=this.device}},{key:"setupPlayerParams",value:function(e){this.params&&"object"===a(this.params)&&(void 0===this.params.advertising&&0==this.noAd&&(this.params.advertising={client:this.client,vpaidmode:this.vpaidMode,autoplayadsmuted:this.mute,tag:this.Adtag}),void 0===this.params.file&&(this.params.file=this.fallBackVideo),this.debugMessage(this.messages.setupParams),this.debugMessage(this.params),""!=this.params.adTags.flashTag?this.params.advertising.client="flash"==this.primary?"vast":"googima":(this.params.advertising.client=1==this.isFlashEnabled&&"flash"==window.jwplayer.defaults.primary?"vast":"googima",this.primary="html5"),this.params.advertising.client="desktop"==this.device?this.params.advertising.client:"googima",this.player.setup(this.params))}},{key:"detectFlash",value:function(){this.isFlashEnabled=o(),this.isFlashEnabled?this.debugMessage(this.messages.flashDetected):this.debugMessage(this.messages.flashNotDetected),"flash"===this.primary&&!1===this.isFlashEnabled&&this.dispatchEvent("fallbacktohtml5"),this.primary=this.isFlashEnabled?"flash":"html5"}},{key:"selectVastTag",value:function(){this.Adtag="flash"===this.primary&&this.AdTagsObj.flashTag?this.AdTagsObj.flashTag:this.AdTagsObj.html5Tag}},{key:"flashFallBack",get:function(){return c.flashFallBack}},{key:"html5fallback",get:function(){return c.html5fallback}},{key:"ADError",get:function(){return d.ADError}},{key:"debugMessage",get:function(){return d.debugMessage}},{key:"errorHandler",get:function(){return d.errorHandler}}]),p}()});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbIi4uL3NyYy9FdmVudERpc3BhdGNoZXIuanMiLCIuLi9zcmMvQXR0YWNoRXZlbnRzLmpzIiwiLi4vc3JjL2ZsYXNoRGV0ZWN0b3IuanMiLCIuLi9zcmMvbWVzc2FnZXMuanMiLCIuLi9zcmMvdXBkYXRlQUR0YWcuanMiLCIuLi9zcmMvZmFsbGJhY2tzLmpzIiwiLi4vc3JjL2xvZ2dlci5qcyIsIi4uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuKiB0aGlzIGNsYXNzIGlzIGEgcHViL3N1YiBpbiBqUXVlcnkgc3R5bGVcbiogd2UgaGF2ZSAub24oKSAuIG9mZigpIG1ldGhvZHMgdG8gYWRkIEV2ZW50IGxpc3RlbmVycyBhbmQgcmVtb3ZlIHRoZW0uXG4qXG4qIGluIG9yZGVyIHRvIGRpc3BhdGNoIHRoZSBldmVudCBwbGVhc2UgdXNlIGRpc3BhdGNoRXZlbnRcbiogaWYgeW91IHdhbnQgdGhlIGV2ZW50IHRvIGJlIGZpcmVkIG9ubHkgb25jZSBwbGVhc2UgdXNlIGRpc3BhdGNPbmNlXG4qXG4qXG4qICovXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEV2ZW50RGlzcGF0Y2hlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIGNvbGxlY3Rpb24gb2Ygc3Vic2NyaXB0aW9uc1xuICAgICAgICB0aGlzLmV2ZW50U3RhY2sgPSBbXTtcblxuICAgICAgICAvLyBjb2xsZWN0aW9uIG9mIHRoZSBldmVudHMgd2hpY2ggYXJlIGFscmVhZHkgZmlyZWRcbiAgICAgICAgLy8gZm9yIGRpc3BhdGNoT25jZSBtZXRob2Qgd2UgY2hlY2sgaWYgdGhlIGV2ZW50IGlzIG5vdCBvbiB0aGlzIGFycmF5XG4gICAgICAgIHRoaXMuZmlyZWRTdGFjayA9IFtdO1xuICAgIH1cblxuICAgIC8vIGF0dGFjaCB0aGUgZXZlbnQgYW5kIGNhbGxiYWNrIHRvIHRoZSBjb250ZXh0XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHlwZSA6IHN0cmluZyAtIGxpc3Qgb2YgdGhlIGV2ZW50IG5hbWVzIHNlcGFyYXRlZCBieSBzcGFjZVxuICAgICAqIEBwYXJhbSBjYWxsYmFjayA6IGZ1bmN0aW9uIC0gdGhlIGNhbGxiYWNrIHRvIGJlIHJ1biB3aGVuIGV2ZW50IGRpc3BhdGNoZXNcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSBmYWxzZSBmb3Igbm9uIHN0cmluZyB0eXBlIHBhcmFtZXRlci4gdHJ1ZSBmb3Igbm9ybWFsIHNjZW5hcmlvXG4gICAgICovXG4gICAgb24odHlwZSwgY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0eXBlICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIC8vIHJlbW92ZSAgZXh0cmEgc3BhY2VzIGZyb20gdGhlIGxpc3RcblxuICAgICAgICBjb25zdCBldmVudExpc3QgPSB0eXBlLnNwbGl0KCcgJykuZmlsdGVyKGl0ZW0gPT4gaXRlbSAhPSAnJyk7XG5cbiAgICAgICAgLy8gYXR0YWNoIG11bHRpcGxlIGV2ZW50c1xuICAgICAgICBldmVudExpc3QuZm9yRWFjaCgoZXZlbnROYW1lKT0+e1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PSAnZnVuY3Rpb24nKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmVudFN0YWNrW2V2ZW50TmFtZV0gID0gIHRoaXMuZXZlbnRTdGFja1tldmVudE5hbWVdIHx8ICBbXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmVudFN0YWNrW2V2ZW50TmFtZV0ucHVzaCAoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gdHJ1ZSA7XG4gICAgfVxuXG4gICAgLy8gcmVtb3ZlIGV2ZW50IGZyb20gdGhlIGNvbnRleHRcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB0eXBlIDogc3RyaW5nIC0gdGhlIGV2ZW50IG5hbWUgdG8gYmUgcmVtb3ZlZCBmcm9tIHRoZSBzdGFja1xuICAgICAqL1xuICAgIG9mZih0eXBlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdHlwZSA9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgdGhpcy5ldmVudFN0YWNrID0gW107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmV2ZW50U3RhY2suc3BsaWNlKHRoaXMuZXZlbnRTdGFjay5pbmRleE9mKHR5cGUpLDEpO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICAvLyBmaXJlIHRoZSBldmVudFxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHR5cGUgOiBzdHJpbmcgLSBldmVudCBuYW1lIHRvIGJlIGRpc3BhdGNoZWRcbiAgICAgKiBAcGFyYW0gZGF0YSA6IGFueSBkYXRhIHdoaWNoIGhhcyB0byBiZSBzZW50IHRvIHRoZSBjYWxsYmFja1xuICAgICAqL1xuICAgIGRpc3BhdGNoRXZlbnQodHlwZSwgZGF0YSA9IHt9KSB7XG4gICAgICAgIGxldCBldnRTdGFjayA9IHRoaXMuZXZlbnRTdGFja1t0eXBlXSB8fCBbXSA7XG5cbiAgICAgICAgaWYgKGV2dFN0YWNrLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5maXJlZFN0YWNrW3R5cGVdID0gdHJ1ZTtcbiAgICAgICAgICAgIGV2dFN0YWNrLmZvckVhY2goKGV2dCkgPT4ge1xuICAgICAgICAgICAgICAgIGV2dC5jYWxsKHRoaXMsIGRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vIGZpcmUgdGhlIGV2ZW50IGlmIGl0IG5vdCBhbHJlYWR5IGZpcmVkLlxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHR5cGUgOiBzdHJpbmcgLSBldmVudCBuYW1lIHRvIGJlIGRpc3BhdGNoZWRcbiAgICAgKiBAcGFyYW0gZGF0YSA6IGFueSBkYXRhIHdoaWNoIGhhcyB0byBiZSBzZW50IHRvIHRoZSBjYWxsYmFja1xuICAgICAqL1xuICAgIGRpc3BhdGNoT25jZSh0eXBlLCBkYXRhKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5maXJlZFN0YWNrW3R5cGVdID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodHlwZSwgZGF0YSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cbiAgICB9XG59IiwiLypcbiogdGhpcyBjbGFzcyBpcyBhIGRlY29yYXRvciB0byBvcmlnaW5hbCBKVyBldmVudHNcbiogYmFzZWQgb24gb3JpZ2luYWwgSldwbGF5ZXIgZXZlbnRzIGZpcmVkIGJ5IHRoZSBwbGF5ZXIgaW5zdGFuY2VcbipcbiogdGhlIENvbXBsZXRlIGV2ZW50IGlzIHRoZSBwbGFjZSB0aGF0IHdlIG1ha2UgYXNzdW1wdGlvbnMgZm9yIE5vQUQgb3IgRmFsbGJhY2sgbG9naWNcbiogRWFjaCBKVyBldmVudCB3aWxsIHRyaWdnZXJcbipcbiogKi9cblxuXG5pbXBvcnQgRXZlbnREaXNwYXRjaGVyIGZyb20gJy4vRXZlbnREaXNwYXRjaGVyJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXR0YWNoRXZlbnRzIGV4dGVuZHMgRXZlbnREaXNwYXRjaGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG5cbiAgICAvLyBhdHRhY2hlIHRoZSBldmVudHMgdG8gdGhlIGRpc3BhdGNoZXJcbiAgICBhdHRhY2hFdmVudHMoKSB7XG4gICAgICAgIC8vIHRoaXMgZXZlbnQgb25seSB3b3JrcyBvbiBWUEFJRCBhZHNcbiAgICAgICAgLy8gZmlyZXMgYXQgdGhlIGZpcnN0IGZyYW1lb2YgdGhlIEFEXG4gICAgICAgIHRoaXMucGxheWVyLm9uKCdhZFN0YXJ0JywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoT25jZSgnYWRTdGFydCcsIGV2ZW50KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gYWRCbG9ja2VyIGV2ZW4gd29ya3Mgd2hlbiB0aGUgcGxheWVyIGlzIGxhb2RlZCBhbmQgdGhlbiB1c2VyIGVuYWJsZXMgdGhlIEFEQmxvY2tlciBvbiB0aGUgYnJvd3NlclxuICAgICAgICAvLyBtb3N0IG9mIGFkQmxvY2tlcnMgd2lsbCBibG9jayB0aGUgSlcgcGxheWVyIEFEIHBsdWdpbnMgdG8gbG9hZFxuICAgICAgICB0aGlzLnBsYXllci5vbignYWRCbG9ja2VyJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoT25jZSgnYWRCbG9ja2VyJywgZXZlbnQpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBJbXByZXNzaW9uIGV2ZW50IGZpcmVzIHRoZSB0aGUgQVBJIHJlcXVlc3QgZmlyZXMgc3VjY2Vzc2Z1bGx5IHRvIEFEIHNlcnZlci5cbiAgICAgICAgLy8gbW9zdCBvZiBBRHMgZmlyZSBpdCBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBBRCAuIHNvbWUgbWlnaHQgZmlyZSBpdCBpbiB0aGUgbWlkZGxlXG4gICAgICAgIC8vIHdlIHVzZSB0aGlzIGV2ZW50IGFzIGEgcmVmZXJlbmNlIG9mIHN1Y2Nlc3NmdWwgQURcblxuICAgICAgICB0aGlzLnBsYXllci5vbignYWRJbXByZXNzaW9uJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRlYnVnTWVzc2FnZSh0aGlzLm1lc3NhZ2VzLmFkSW1wcmVzc2lvbiArIHRoaXMucHJpbWFyeSArICcgVGFnJyk7XG4gICAgICAgICAgICB0aGlzLmFkSW1wcmVzc2lvbiA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoT25jZSgnYWRJbXByZXNzaW9uJywgZXZlbnQpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBmaXJlIHdoZW4gdXNlciBtYW51YWxseSBoaXRzIHRoZSBza2lwIGJ1dHRvbiBvbiB0aGUgQUQuXG4gICAgICAgIC8vIGZvciBvdXIgdXNlciBleHBlcmllbmNlIGl0IGlzIHRoZSBzYW1lIHBvaW50IGxpa2UgYWRDb21wbGV0ZVxuICAgICAgICB0aGlzLnBsYXllci5vbignYWRTa2lwcGVkJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoT25jZSgnYWRTa2lwcGVkJywgZXZlbnQpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBvcmlnaW5hbCBhZFRpbWUgRXZlbnQgZmlyZXMgY29uc3RhbnRseSB3aGVuIHRoZSBBRCBpcyBwbGF5aW5nXG4gICAgICAgIC8vIGluIG91ciBkZWNvcmF0b3Igd2UgZmlyZSBpdCBvbmx5IG9uY2Ugd2UgZ2V0IGl0IGZvciB0aGUgZmlyc3QgdGltZS5cbiAgICAgICAgLy8gaGVuY2UgdGhpcyBldmVudCBnaXZlcyB1cyB0aGUgYWQgZHVyYXRpb24uXG4gICAgICAgIC8vIFNvbWUgQURzIHJlcG9ydCB0aGVpciBkdXJhdGlvbiBpbmNvcnJlY3RseSBsaWtlIDMwIHNlYyBhbGwgdGhlIHRpbWUuXG4gICAgICAgIC8vIHNvIGl0IGlzIGJldHRlciB0byB1c2UgdGhpcyBldmVudCBmb3IgbG9nZ2luZyBwdXJwb3NlcyBvbmx5XG4gICAgICAgIHRoaXMucGxheWVyLm9uKCdhZFRpbWUnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlbWFpbmluZyA9IE1hdGgucm91bmQoZXZlbnQuZHVyYXRpb24gLSBldmVudC5wb3NpdGlvbik7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoT25jZSgnYWRUaW1lJywgcmVtYWluaW5nKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gZmlyZXMgd2hlbiB1c2VyIGNsaWNrIG9uIHZpZGVvXG4gICAgICAgIHRoaXMucGxheWVyLm9uKCdhZENsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoT25jZSgnYWRDbGljaycsIGV2ZW50KTtcbiAgICAgICAgfSk7XG5cblxuICAgICAgICAvLyBBRCBlcnJvciBpcyBhIGNvbXBsaWNhdGVkIGV2ZW50LiB3aGVuIHdlIGdldCBlcnJvcnMgaW4gdGhlIEFEIHN0YWNrLCB3ZSBnZXQgYW4gYWRFcnJvciB3aXRoIHNvbWUgbWVzc2FnZXMuXG4gICAgICAgIC8vIGl0IGRvZXMgbm90IG1lYW4gdGhhdCB3ZSB3aWxsIG5vdCBnZXQgQUQgYWZ0ZXIgdGhpcyBlcnJvci5cbiAgICAgICAgLy8gcGxheWVyIG1pZ2h0IGZpcmUgYW5vdGhlciBhZFJlcXVlc3QgYW5kIHNob3cgdGhlIEFEIGFmdGVyIHRoaXMgZXZlbnQuXG4gICAgICAgIC8vIHRoZSBvbmx5IHJlbGlhYmxlIGV2ZW50IGZvciBubyBmaWxsIHNjZW5hcmlvIGlzIHRoZSBub0FkIGV2ZW50LlxuICAgICAgICB0aGlzLnBsYXllci5vbignYWRFcnJvcicsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5BREVycm9yKGV2ZW50KTtcbiAgICAgICAgfSk7XG5cblxuICAgICAgICAvLyBmaXJlcyB3aGVuIHRoZSBpcyBmaW5pc2hlZCBhZCBwbGF5ZXIgaXMgZ29pbmcgdG8gc2hvdyB0aGUgdmlkZW8gY29udGVudFxuICAgICAgICAvLyBzb21lIEFkcyBmaXJlIHRoZSBhZEltcHJlc3Npb24gYnV0IGRvIG5vdCBmaXJlIHRoZSBhZENvbXBsZXRlLlxuICAgICAgICAvLyBmb3IgdGhvc2UgYWRzIHdlIGhhdmUgYW5vdGhlciBsb2dpYyB0byB0cmlnZ2VyIGFkQ29tcGxldGUgbWFudWFsbHlcbiAgICAgICAgdGhpcy5wbGF5ZXIub24oJ2FkQ29tcGxldGUnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGVGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZGVidWdNZXNzYWdlKHRoaXMubWVzc2FnZXMuYWRDb21wbGV0ZSk7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2FkQ29tcGxldGUnLCBldmVudCk7XG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgLy8gdGhpcyBpcyB0aGUgcGxhY2UgdGhlIHZpZGVvIGNvbnRlbnQgZmluaXNoZXMuXG4gICAgICAgIC8vIHdlIG5lZWQgdG8gdmVyaWZ5IHRoZSBhZEltcHJlc3Npb24gZmxhZyB0byBtYWtlIHN1cmUgd2UgbmVlZCBhIGZhbGxiYWNrIHRvIHRoZSBzZWNvbmQgdGFnLlxuICAgICAgICAvLyBpbiB0aGUgY2FzZSB3ZSBnZXQgdGhlIGFkSW1wcmVzc2lvbiBidXQgbm8gYWRDb21wbGV0ZSB3ZSBmaXJlIGZvcmNlQWRjb21wbGV0ZVxuICAgICAgICAvLyBpZiB0aGUgZmFsbGJhY2sgaXMgZW5hYmxlZCBhbmQgd2UgZ2V0IG5vIGFkSW1wcmVzc2lvbiBvbiB0aGUgZmlyc3QgdGFnIHdlIGZhbGxiYWNrIHRvIDJuZCB0YWdcbiAgICAgICAgLy8gaWYgYm90aCB0YWcgaGFkIG5vIGZpbGwgdGhlbiB3ZSBmaXJlIHRoZSBub0FkXG5cbiAgICAgICAgdGhpcy5wbGF5ZXIub24oJ2NvbXBsZXRlJywgKCkgPT4ge1xuXG4gICAgICAgICAgICBpZiAodGhpcy5hZEltcHJlc3Npb24gPT0gdHJ1ZSkge1xuXG4gICAgICAgICAgICAgICAgLy8gZm9yY2UgdGhlIGFkY29tcGxldGUgZXZlbnQgaWYgdGhlIEFEIGRpZCBub3QgZmlyZSB0aGF0XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29tcGxldGVGbGFnICE9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWJ1Z01lc3NhZ2UodGhpcy5tZXNzYWdlcy5mb3JjZUFkQ29tcGxldGUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2FkQ29tcGxldGUnLCAnZm9yY2VDb21wbGV0ZScpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZmlyZSBObyBBRCBpZiB0aGUgZmFsbGJhY2sgaXMgZGlzYWJsZWRcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW1wcmVzc2lvbiA9PSBmYWxzZVxuICAgICAgICAgICAgICAgICYmIHRoaXMuZmFsbEJhY2tFbmFibGVkID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdub0FkJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlICBhbnkgZmFsbGJhY2tcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW1wcmVzc2lvbiA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZhbGxCYWNrRmxhZyA9PSBmYWxzZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmFsbEJhY2tGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYWxsQmFja1RpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5IVE1MRmlyc3QpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgZm9yIGZsYXNoIGlmIHRoZSBmbGFzaCBpcyB0aGUgc2Vjb25kIFRBR1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXRlY3RGbGFzaCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNGbGFzaEVuYWJsZWQgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ25vQWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmxhc2hGYWxsQmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5odG1sNWZhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbm8gaW1wcmVzc2lvbiBhZnRlciBmYWxsYmFja1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vQWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ25vQWQnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICB9XG59IiwiLyoqXG4gKiB0aGlzIGZ1bmN0aW9ucyBjaGVja3MgdGhlIGJyb3dzZXIgY2FwYWJpbGl0aWVzIGFuZCByZXR1cm5zIGEgYm9vbGVhbiBpZiBmbGFzaCBwbGF5ZXIgaXMgaW5zdGFsbGVkIGFuZCBhY3RpdmUgb25cbiAqIHRoZSBicm93c2VyXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAqL1xuXG5jb25zdCAgZmxhc2hEZXRlY3RvciA9ICgpPT4ge1xuICAgIC8vIHNldCB0aGUgZmxhZyBmb3IgZmxhc2ggcGxheWVyXG4gICBsZXQgaXNGbGFzaEVuYWJsZWQgPSBmYWxzZTtcbiAgICBjb25zdCBwbHVnaW5zID0gd2luZG93Lm5hdmlnYXRvci5wbHVnaW5zO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGx1Z2lucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoL2ZsYXNoL2kudGVzdChwbHVnaW5zW2ldLm5hbWUpKSB7XG5cbiAgICAgICAgICAgIGlzRmxhc2hFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaXNGbGFzaEVuYWJsZWQgO1xufVxuIGV4cG9ydCBkZWZhdWx0IGZsYXNoRGV0ZWN0b3I7IiwiLyoqXG4gKiBjb2xsZWN0aW9uIHRoZSBjb25zb2xlIG1lc3NhZ2VzIHdpdGggdGhlaXIgY29ycmVzcG9uZGluZyBldmVudCBuYW1lc1xuICpcbiAqL1xuZXhwb3J0IGRlZmF1bHQgICB7XG4gICAgYWRJbXByZXNzaW9uOiAnYWQgaW1wcmVzc2lvbiBvbiAnLFxuICAgIGFkQ29tcGxldGU6ICdhZENvbXBsZXRlJyxcbiAgICBmYWxsQmFja3RvRmxhc2g6ICdmbGFzaCBmYWxsYmFjaycsXG4gICAgaHRtbEZhbGxCYWNrOiAnSFRNTDUgZmFsbGJhY2snLFxuICAgIG5vQUQ6ICcgbm9BRCcsXG4gICAgZm9yY2VBZENvbXBsZXRlOiAnZm9yY2UgQUQgQ29tcGxldGUnLFxuICAgIHNldHVwUGFyYW1zOiAnIHRoZSBzZXR1cCBwYXJhbWV0ZXJzJyxcbiAgICBmbGFzaERldGVjdGVkOiAnIGZsYXNoIHBsYXllciBkZXRlY3RlZCcsXG4gICAgZmxhc2hOb3REZXRlY3RlZDogJ2ZsYXNoIHBsYXllciBub3QgZGV0ZWN0ZWQnLFxuICAgIGp3cGxheWVyU2NyaXB0RXJyb3IgOicgSlcgcGxheWVyIHNjcmlwdCBpcyBub3QgYXZhaWxhYmxlJyxcbiAgICBjb250YWluZXJFcnJvciA6ICdET00gY29udGFpbmVyIG5vdCBmb3VuZCBFcnJvcicsXG4gICAgYWRFcnJvciA6ICcgQUQgRXJyb3IgJyxcbiAgICBwbGF5Q29udGVudCA6ICdwbGF5aW5nIGNvbnRlbnQgJyxcbiAgICBmYWxsYmFja1RvVmlkZW8gOiAnZmFsbGJhY2sgdG8gdmlkZW8nXG59XG4iLCIvKipcbiAqICB0aGlzIGZ1bmN0aW9uIHRha2VzIHRlIERGUCB0YWcgYXMgYSBzdHJpbmcgYW5kIHVwZGF0ZWQgdGhlIGN1c3RvbSBwYXJhbXMgYW5kIG90aGVyXG4gKiBAcGFyYW0gdGFnOlN0cmluZyAtICB0aGUgREZQIHRhZ1xuICogQHJldHVybnMgQUR0YWc6c3RyaW5nIC0gdGhlIHVwZGF0ZWQgREZQIHRhZyAuIHdpbGwgcmV0dXJuIGVtcHR5IGlmIHRoZSBwYXJhbWV0ZXIgaXMgZW1wdHkgb3IgdGhlIHR5cGUgaXMgaW5jb3JyZWN0XG4gKi9cbmNvbnN0IHVwZGF0ZUFEdGFnID0gdGFnID0+IHtcblxuICAgIGlmICh0YWcgPT0nJyB8fCB0eXBlb2YgdGFnICE9PSAnc3RyaW5nJykgcmV0dXJuICcnO1xuXG4gICAgbGV0IEFEdGFnID0gdGFnO1xuICAgIC8vIHJlcGxhY2UgYnJhY2tldHMgd2l0aCBkZWZhdWx0IHZhbHVlc1xuICAgIEFEdGFnID0gQUR0YWcucmVwbGFjZSgnW3JlZmVycmVyX3VybF0nLCBlbmNvZGVVUklDb21wb25lbnQod2luZG93LmxvY2F0aW9uLmhyZWYpKTtcbiAgICBBRHRhZyA9IEFEdGFnLnJlcGxhY2UoJ1tkZXNjcmlwdGlvbl91cmxdJywgZW5jb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5sb2NhdGlvbi5ocmVmKSk7XG4gICAgQUR0YWcgPSBBRHRhZy5yZXBsYWNlKCdbdGltZXN0YW1wXScsIERhdGUubm93KCkpO1xuXG4gICAgaWYoIHR5cGVvZiB3aW5kb3cuUENIVVNFUiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgLy8gdXBkYXRlIHRoZSB2YXN0IHRhZyB3aXRoIHBhcmFtc1xuICAgICAgICBsZXQgdXJsUGFyYW1PYmogPSB7fTtcbiAgICAgICAgdXJsUGFyYW1PYmouYSA9IFBDSFVTRVIuYWdlIHx8ICcnO1xuICAgICAgICB1cmxQYXJhbU9iai5nID0gUENIVVNFUi5nZW5kZXIgIT0gXCJcIiA/IChQQ0hVU0VSLmdlbmRlciA9PSBcIm1cIiB8fCBQQ0hVU0VSLmdlbmRlciA9PSBcIjFcIiA/IFwiMVwiIDogXCIyXCIpIDogXCJcIjtcbiAgICAgICAgdXJsUGFyYW1PYmouYXIgPSBQQ0hVU0VSLmFnZVJhbmdlIHx8ICcnO1xuICAgICAgICB1cmxQYXJhbU9iai5zZWcgPSBQQ0hVU0VSLnNlZ21lbnRzIHx8ICcnO1xuICAgICAgICB1cmxQYXJhbU9iai5nbXQgPSBQQ0hVU0VSLmdtdCB8fCAnJztcbiAgICAgICAgdXJsUGFyYW1PYmoubGV2ZWwgPSBQQ0hVU0VSLmxldmVsIHx8ICcnO1xuICAgICAgICB1cmxQYXJhbU9iai5yZWdsaXN0ID0gUENIVVNFUi5yZWdsaXN0LmpvaW4oKSB8fCAnJztcblxuICAgICAgICBsZXQgdXJsUGFyYW1zID0gJyc7XG4gICAgICAgIHVybFBhcmFtcyA9ICdhPScgKyB1cmxQYXJhbU9iai5hICsgJyZnPScgKyB1cmxQYXJhbU9iai5nICsgJyZzZWc9JyArIHVybFBhcmFtT2JqLnNlZyArICcmZ210PScgKyAodXJsUGFyYW1PYmouZ210KSArICcmbGV2ZWw9JyArICh1cmxQYXJhbU9iai5sZXZlbCkgKyAnJicgKyAncmVnbGlzdD0nICsgKHVybFBhcmFtT2JqLnJlZ2xpc3QpO1xuICAgICAgICBBRHRhZyArPSAnJmN1c3RfcGFyYW1zPScgKyBlbmNvZGVVUklDb21wb25lbnQodXJsUGFyYW1zKTtcbiAgICB9XG5cbiAgICByZXR1cm4gQUR0YWc7XG59XG5cbiBleHBvcnQgZGVmYXVsdCB1cGRhdGVBRHRhZyA7IiwiLyoqXG4gKlxuICogZmFsbGJhY2sgbWV0aG9kcyB3aWxsIGZpcmUgd2hlbiB0aGUgZmlyc3QgdGFnIGNvbWVzIGJhY2sgd2l0aCBubyBmaWxsIGFuZCB3ZSB3YW50IHRoZSAybmQgdGFnXG4gKiBiYXNlZCBvbiBjb25maWd1cmF0aW9uIHdlIGhhdmUgZmxhc2gvaHRtbCBvciBodG1sL2ZsYXNoIGZhbGxiYWNrc1xuICpcbiAqL1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcblxuXG4gICAgLy8gZmFsbCBiYWNrIHRvIGZsYXNoIHdoZW4gZmxhc2ggIG5vdCBhdmFpbGFibGUgYW5kIEhUTUwgaGFkIG5vIGZpbGxcbiAgICBmbGFzaEZhbGxCYWNrKCkge1xuICAgICAgICB0aGlzLnByaW1hcnkgPSAnZmxhc2gnO1xuXG4gICAgICAgIHRoaXMuZGVidWdNZXNzYWdlKHRoaXMubWVzc2FnZXMuZmFsbEJhY2t0b0ZsYXNoKTtcbiAgICAgICAgdGhpcy5zZWxlY3RWYXN0VGFnKCk7XG4gICAgICAgIGlmICh0aGlzLnBhcmFtcy5hZHZlcnRpc2luZykgdGhpcy5wYXJhbXMuYWR2ZXJ0aXNpbmcudGFnID0gdGhpcy5BZHRhZztcblxuICAgICAgICB0aGlzLmRlYnVnTWVzc2FnZSh0aGlzLm1lc3NhZ2VzLnNldHVwUGFyYW1zKTtcbiAgICAgICAgdGhpcy5zZXR1cFBsYXllclBhcmFtcyh0aGlzLnBhcmFtcyk7XG4gICAgICAgIGp3cGxheWVyKCkub24oJ3JlYWR5JywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hdHRhY2hFdmVudHMoKTtcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnZmFsbGJhY2tDb21wbGV0ZScsICdmbGFzaCcpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG5cbiAgICAvLyBmYWxsIGJhY2sgdG8gaHRtbCB3aGVuIGZsYXNoIGlzIG5vdCBhdmFpbGFibGVcbiAgICBodG1sNWZhbGxiYWNrKCkge1xuICAgICAgICB0aGlzLnByaW1hcnkgPSAnaHRtbDUnO1xuXG4gICAgICAgIHRoaXMuZGVidWdNZXNzYWdlKHRoaXMubWVzc2FnZXMuaHRtbEZhbGxCYWNrKTtcbiAgICAgICAgdGhpcy5zZWxlY3RWYXN0VGFnKCk7XG4gICAgICAgIGlmICh0aGlzLnBhcmFtcy5hZHZlcnRpc2luZykgdGhpcy5wYXJhbXMuYWR2ZXJ0aXNpbmcudGFnID0gdGhpcy5BZHRhZztcblxuICAgICAgICB0aGlzLmRlYnVnTWVzc2FnZSh0aGlzLnBhcmFtcyk7XG4gICAgICAgIHRoaXMuc2V0dXBQbGF5ZXJQYXJhbXModGhpcy5wYXJhbXMpO1xuICAgICAgICBqd3BsYXllcigpLm9uKCdyZWFkeScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuYXR0YWNoRXZlbnRzKCk7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2ZhbGxiYWNrQ29tcGxldGUnLCAnSFRNTDUnKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuXG4gICAgLy8gc2hvdyBmYWxsYmFjayB2aWRlbyBpZiB0aGUgd2FzIE5vIEFkIGluIGJvdGggdGFnc1xuICAgIHZpZGVvRmFsbGJhY2soKSB7XG4gICAgLy8gIFRPRE8gZmVhdHVyZSBmb3IgZnV0dXJlXG5cbiAgICB9XG59IiwiLy8gaGFuZGxlIHRoZSBhZEVycm9yIGV2ZW50IGZyb20gandwbGF5ZXJcbi8qKlxuICogbWV0aG9kcyB0byBkcm9wIGNvbnNvbGUgbWVzc2FnZXNcbiAqXG4gKi9cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICAvKipcbiAgICAgKiAgbG9nIHRoZSBtZXNzYWdlIG9uIEFERXJyb3JcbiAgICAgKiBAcGFyYW0gbXNnOiBzdHJpbmdcbiAgICAgKlxuICAgICAqL1xuICAgIEFERXJyb3IobXNnKSB7XG5cbiAgICAgICAgdGhpcy5kZWJ1Z01lc3NhZ2UoJ2Vycm9yIG9uIEFEICcpO1xuICAgICAgICB0aGlzLmRlYnVnTWVzc2FnZShtc2cpO1xuXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hPbmNlKCdhZEVycm9yJywgbXNnKTtcblxuICAgIH0sXG5cblxuXG4gICAgLyoqIGRyb3AgdGhlIGNvbnNvbGUgbWVzc2FnZXNcbiAgICAgKlxuICAgICAqIEBwYXJhbSBtc2c6IHN0cmluZ1xuICAgICAqL1xuICAgIGRlYnVnTWVzc2FnZShtc2cpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVidWdNb2RlID09IGZhbHNlKSByZXR1cm47XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1BDSCBWaWRlbyBNZXNzYWdlID4+Pj4gJywgbXNnKTtcbiAgICB9LFxuXG5cbiAgICAvKiogc2V0IHRoZSBlcnJvciBmbGFnXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXJyOnN0cmluZ1xuICAgICAqL1xuICAgIGVycm9ySGFuZGxlcihlcnIpIHtcbiAgICAgICAgdGhpcy5lcnJvckZsYWcgPSB0cnVlO1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH1cbn0iLCIvKipcbiAqIENyZWF0ZWQgYnkgaHlhZ2hpbmxvbyBvbiAxLzI0LzE3LlxuICovXG5cblxuLypcbipcbiogIFBDSCB2aWRlbyBwbGF5ZXIgYmFzZWQgb24gSlcgIHBsYXllclxuKiAgdGhpcyBjbGFzcyBpcyB0aGUgbWFpbiAgY2xhc3MgaW4gdGhlIHBhY2thZ2UgbmFkIHRoZSBlbnRyeSBwb2ludCB0aGUgYnVpbGRcbipcbiovXG5cbmltcG9ydCBBdHRhY2hFdmVudHMgZnJvbSAnLi9BdHRhY2hFdmVudHMnO1xuaW1wb3J0IGZsYXNoRGV0ZWN0b3IgZnJvbSAnLi9mbGFzaERldGVjdG9yJyA7XG5pbXBvcnQgKiBhcyBtZXNzYWdlcyBmcm9tICcuL21lc3NhZ2VzJztcbmltcG9ydCB1cGRhdGVUYWcgZnJvbSAnLi91cGRhdGVBRHRhZyc7XG5pbXBvcnQgKiBhcyBmYWxsYmFja3MgZnJvbSAnLi9mYWxsYmFja3MnO1xuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJy4vbG9nZ2VyJztcblxuXG5jbGFzcyBQY2hWaWRlb1BsYXllciBleHRlbmRzIEF0dGFjaEV2ZW50cyB7XG4gICAgLyoqXG4gICAgICogc2V0dXAgcGFyYW1zIGZyb20gdGhlIGNvbnN1bWVyIHNpZGVcblxuICAgICAqXG4gICAgICogQHBhcmFtIHNldHVwUGFyYW1zIDogb2JqZWN0XG4gICAgICogaGVyZSBpcyB0aGUgbGlzdCBvZiBtYW5kYXRvcnkgYW5kIG9wdGlvbmFsIGtleXNcbiAgICAgKlxuICAgICAqIGNvbnRhaW5lciA6IHN0cmluZyAtIHRoZSBJRCBvZiB0aGUgRE9NIGVsZW1lbnQgdG8gY29udGFpbiBKVyBwbGF5ZXJcbiAgICAgKiBhZFRhZ3MgOiBvYmplY3QgLSB3aXRoIHRobyBrZXkgJ2ZsYXNoVGFnJyBhbmQgJ2h0bWw1VGFnJ1xuICAgICAqIGFkUGx1Z2luIDogc3RyaW5nIC0gJ3Zhc3QnIG9yICdnb29naW1hJyAvLyBvcHRpb25hbFxuICAgICAqIHZwYWlkbW9kZTogc3RyaW5nIC0gJ3NlY3VyZScgb3IgJ2luc2VjdXJlJyAvLyBvcHRpb25hbFxuICAgICAqIHVwZGF0ZVRhZyA6IGJvb2xlYW4gLSBzZXQgaXQgdG8gdHJ1ZSBpZiB5b3Ugd2FudCB0aGUgREZQIHRhZ3MgdG8gYmUgdXBkYXRlZCAvLyBvcHRpb25hbFxuICAgICAqIGh0bWxGaXJzdCA6IGJvb2xlYW4gLSBzZXQgaXQgdG8gdHJ1ZSBpZiB5b3Ugd2FudCB0byBmaXJlIEhUTUwgdGFnIGZpcnN0IGluIHRoZSBmYWxsYmFjayAvLyBvcHRpb25hbFxuICAgICAqIGRldmljZSA6IHN0cmluZyAtICdkZXZpY2UnICwgJ3RhYmxldCcgb3IgJ21vYmlsZScgLiBpdCB3aWxsIHNraXAgdGhlIGZsYXNoIHRhZyBmb3Igbm9uIGRlc2t0b3AgZGV2aWNlcy5cblxuICAgICAqKi9cbiAgICBjb25zdHJ1Y3RvcihzZXR1cFBhcmFtcykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm1lc3NhZ2VzID0gbWVzc2FnZXMuZGVmYXVsdDtcbiAgICAgICAgdGhpcy5ldmVudFN0YWNrID0gW107XG4gICAgICAgIHRoaXMuZmlyZWRTdGFjayA9IFtdO1xuICAgICAgICB0aGlzLm5vQWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5mYWxsQmFja0ZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb21wbGV0ZUZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5mYWxsQmFja1RpbWUgPSBudWxsO1xuICAgICAgICB0aGlzLmZsYXNoQWRFbXRweSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzRmxhc2hFbmFibGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaHRtbEFERW1wdHkgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5lcnJvckZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wYXJhbXMgPSBzZXR1cFBhcmFtcztcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSB0aGlzLnBhcmFtcy5jb250YWluZXI7XG4gICAgICAgIHRoaXMuQWRUYWdzT2JqID0gdGhpcy5wYXJhbXMuYWRUYWdzO1xuICAgICAgICB0aGlzLnByaW1hcnkgPSB3aW5kb3cuandwbGF5ZXIuZGVmYXVsdHMucHJpbWFyeSB8fCAnaHRtbDUnO1xuICAgICAgICB0aGlzLmZhbGxCYWNrRW5hYmxlZCA9IHdpbmRvdy5qd3BsYXllci5kZWZhdWx0cy5wcmltYXJ5ID09PSAnZmxhc2gnO1xuICAgICAgICB0aGlzLmNsaWVudCA9IHRoaXMucGFyYW1zLmFkUGx1Z2luIHx8ICdnb29naW1hJztcbiAgICAgICAgdGhpcy5BZHRhZyA9IG51bGw7XG4gICAgICAgIHRoaXMuZmFsbEJhY2tWaWRlbyA9IHRoaXMucGFyYW1zLmZhbGxCYWNrVmlkZW8gfHwgJyc7XG4gICAgICAgIHRoaXMuYWRJbXByZXNzaW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMudnBhaWRNb2RlID0gdGhpcy5wYXJhbXMudnBhaWRtb2RlIHx8IFwiaW5zZWN1cmVcIjtcbiAgICAgICAgdGhpcy51cGRhdGVERlB0YWcgPSB0aGlzLnBhcmFtcy51cGRhdGVUYWcgfHwgZmFsc2U7XG4gICAgICAgIHRoaXMuYWRUZWNoID0ge2ZpcnN0VGFnOiAnZmxhc2gnLCBzZWNvbmRUYWc6ICdodG1sNSd9O1xuICAgICAgICB0aGlzLkhUTUxGaXJzdCA9IHRoaXMucGFyYW1zLmh0bWxGaXJzdCB8fCBmYWxzZTtcbiAgICAgICAgdGhpcy5oYXNGbGFzaFRhZyA9IHRydWU7XG4gICAgICAgIHRoaXMubXV0ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuZGV2aWNlID0gdGhpcy5wYXJhbXMuZGV2aWNlLnRvTG93ZXJDYXNlKCkgfHwgJ21vYmlsZSc7XG4gICAgICAgIGlmICh0aGlzLkhUTUxGaXJzdCAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHRoaXMuYWRUZWNoID0ge2ZpcnN0VGFnOiAnaHRtbDUnLCBzZWNvbmRUYWc6ICdmbGFzaCd9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2hlY2sgaWYgd2UgYXJlIG9uIGRlYnVnIG1vZGVcbiAgICAgICAgdGhpcy5kZWJ1Z01vZGUgPSB0aGlzLnBhcmFtcy5kZWJ1Z01vZGUgfHwgKC9wY2h2aWRlb2RlYnVnPTF8LnFhLnwuc3RnLnwuZGV2Li9pLnRlc3Qod2luZG93LmxvY2F0aW9uLmhyZWYpICkgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhc3QgdGFncyBhcmUgbm90IHVuZGVmaW5lZFxuICAgICAgICBpZiAodGhpcy5wYXJhbXMuYWRUYWdzICYmIHR5cGVvZiB0aGlzLnBhcmFtcy5hZFRhZ3MuZmxhc2hUYWcgIT0gJ3N0cmluZycpIHRoaXMucGFyYW1zLmFkVGFncy5mbGFzaFRhZyA9ICcnO1xuICAgICAgICBpZiAodGhpcy5wYXJhbXMuYWRUYWdzICYmIHR5cGVvZiB0aGlzLnBhcmFtcy5hZFRhZ3MuaHRtbDVUYWcgIT0gJ3N0cmluZycpIHRoaXMucGFyYW1zLmFkVGFncy5odG1sNVRhZyA9ICcnO1xuXG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZXJlIGlzIGEgZmxhc2ggdGFnXG4gICAgICAgIHRoaXMuaGFzRmxhc2hUYWcgPSAodGhpcy5BZFRhZ3NPYmouZmxhc2hUYWcgIT09ICcnKSA/IHRydWUgOiBmYWxzZTtcblxuXG4gICAgICAgIC8vIHJvbGwgYmFjayB0byBIVE1MNSBpZiB0aGUgZmxhc2ggdGFnIGlzIGVtcHR5XG4gICAgICAgIGlmICh0aGlzLnByaW1hcnkgPT0gJ2ZsYXNoJyAmJiAhdGhpcy5oYXNGbGFzaFRhZykge1xuICAgICAgICAgICAgdGhpcy5wcmltYXJ5ID09ICdodG1sNSc7XG4gICAgICAgICAgICB0aGlzLmZhbGxCYWNrRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gdXBkYXRlIHRoZSBERlAgdGFncyB3aXRoIGN1c3RvbSBwYXJhbXNcbiAgICAgICAgaWYgKHRoaXMudXBkYXRlREZQdGFnKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5oYXNGbGFzaFRhZykgdGhpcy5wYXJhbXMuYWRUYWdzLmZsYXNoVGFnID0gdXBkYXRlVGFnKHRoaXMucGFyYW1zLmFkVGFncy5mbGFzaFRhZyk7XG5cbiAgICAgICAgICAgIHRoaXMucGFyYW1zLmFkVGFncy5odG1sNVRhZyA9IHVwZGF0ZVRhZyh0aGlzLnBhcmFtcy5hZFRhZ3MuaHRtbDVUYWcpO1xuICAgICAgICB9XG5cblxuICAgICAgICAvLyBjaGVjayBmb3IgSldwbGF5ZXIgc2NyaXB0IGFuZCBjb250YWluZXIgZWxlbWVudFxuICAgICAgICB0aGlzLnNldEluaXRpYWxTdGF0ZSgpO1xuXG4gICAgICAgIC8vIGNoZWNrIGZvciB0aGUgQURUeXBlXG4gICAgICAgIC8vIGluIHRoZSBjYXNlIHRoZSBmbGFzaCBmaXJzdCBpcyByZXF1ZXN0ZWQgd2UgZ28gZm9yIGZsYXNoXG4gICAgICAgIGlmICh0aGlzLnByaW1hcnkgPT09ICdmbGFzaCcgJiYgdGhpcy5IVE1MRmlyc3QgPT0gZmFsc2UpIHRoaXMuZGV0ZWN0Rmxhc2goKTtcblxuXG4gICAgICAgIC8vIGdvIGZvciBHb29nbGUgSU1BIGlmIEhUTUwgaXMgdGhlIGZpcnN0XG4gICAgICAgIGlmICh0aGlzLkhUTUxGaXJzdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICB0aGlzLnByaW1hcnkgPSAnaHRtbDUnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcGljayB0aGUgcmlnaHQgdGFnIGJhc2VkIG9uIHNldHVwXG4gICAgICAgIHRoaXMuc2VsZWN0VmFzdFRhZygpO1xuXG4gICAgICAgIC8vIHRoaXMgbWV0aG9kIGlzIHJlc3Bvc2libGUgZm9yIHNldHVwIHRoZSBpbnN0YW5jZSBvZiBKVyBwbGF5ZXJcbiAgICAgICAgdGhpcy5zZXR1cFBsYXllclBhcmFtcyh0aGlzLnBhcmFtcyk7XG4gICAgICAgIGp3cGxheWVyKCkub24oJ3JlYWR5JywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hdHRhY2hFdmVudHMoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvLyBjaGVjayBmb3IgandwbGF5ZXIgc2NyaXB0IGFuZCB0YWtlIHRoZSBpbnN0YW5jZSBmcm9tIGl0XG4gICAgc2V0SW5pdGlhbFN0YXRlKCkge1xuXG4gICAgICAgIC8vIGlmIERPTSBlbGVtZW50IHdhcyBub3QgdGhlcmUgLCB0aHJvdyB0aGUgZXJyb3JcbiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuY29udGFpbmVyKSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5lcnJvckhhbmRsZXIodGhpcy5tZXNzYWdlcy5jb250YWluZXJFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAod2luZG93Lmp3cGxheWVyKSB7XG4gICAgICAgICAgICB0aGlzLnBsYXllciA9IHdpbmRvdy5qd3BsYXllcih0aGlzLmNvbnRhaW5lcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmVycm9ySGFuZGxlcih0aGlzLm1lc3NhZ2VzLmp3cGxheWVyU2NyaXB0RXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wcmltYXJ5ID0gKHRoaXMuZGV2aWNlID09ICdkZXNrdG9wJykgPyB0aGlzLnByaW1hcnkgOiAnaHRtbDUnO1xuICAgICAgICB0aGlzLm11dGUgPSAodGhpcy5kZXZpY2UgIT0gJ2Rlc2t0b3AnKTtcblxuICAgIH1cblxuXG4gICAgLy8gcGxheWVyIHNldHVwXG4gICAgLy8gcGljayB0aGUgcmlnaHQgQUQgY2xpZW50XG4gICAgLy9cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXMgOiBvYmplY3QgLSBzZXR1cCBwYXJhbWV0ZXJzIGNvbWluZyBmcm9tIHRoZSBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIHNldHVwUGxheWVyUGFyYW1zKHBhcmFtcykge1xuXG5cbiAgICAgICAgLy8gY2hlY2sgdGhlIHBhcmFtcyBvYmogYW5kIHNldHVwIHRoZSBKVyBwbGF5ZXJcbiAgICAgICAgaWYgKHRoaXMucGFyYW1zICYmIHR5cGVvZiB0aGlzLnBhcmFtcyA9PT0gJ29iamVjdCcpIHtcblxuICAgICAgICAgICAgLy8gaWYgdGhlcmUgaXMgbm8gQUQgdGFnIGluIHBhcmFtcyB0YWtlIHRoZSBBRCB0YWcgaW4gY29uc3RydWN0b3JcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5wYXJhbXMuYWR2ZXJ0aXNpbmcgPT09ICd1bmRlZmluZWQnICYmIHRoaXMubm9BZCA9PSBmYWxzZSlcblxuICAgICAgICAgICAgICAgIHRoaXMucGFyYW1zLmFkdmVydGlzaW5nID0ge1xuICAgICAgICAgICAgICAgICAgICBjbGllbnQ6IHRoaXMuY2xpZW50LFxuICAgICAgICAgICAgICAgICAgICB2cGFpZG1vZGU6IHRoaXMudnBhaWRNb2RlLFxuICAgICAgICAgICAgICAgICAgICBhdXRvcGxheWFkc211dGVkOiB0aGlzLm11dGUsXG4gICAgICAgICAgICAgICAgICAgIHRhZzogdGhpcy5BZHRhZ1xuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyBmYWxsYmFja3ZpZGVvIGluIHBhcmFtcyB0YWtlIGl0IGZyb20gY29uc3RydWN0b3JcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5wYXJhbXMuZmlsZSA9PT0gJ3VuZGVmaW5lZCcpIHRoaXMucGFyYW1zLmZpbGUgPSB0aGlzLmZhbGxCYWNrVmlkZW87XG5cbiAgICAgICAgICAgIHRoaXMuZGVidWdNZXNzYWdlKHRoaXMubWVzc2FnZXMuc2V0dXBQYXJhbXMpO1xuICAgICAgICAgICAgdGhpcy5kZWJ1Z01lc3NhZ2UodGhpcy5wYXJhbXMpO1xuXG5cbiAgICAgICAgICAgIC8vc2V0dXAgdGhlIGFkY2xpZW50XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJhbXMuYWRUYWdzLmZsYXNoVGFnICE9ICcnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJhbXMuYWR2ZXJ0aXNpbmcuY2xpZW50ID0gKHRoaXMucHJpbWFyeSA9PSAnZmxhc2gnKSA/ICd2YXN0JyA6ICdnb29naW1hJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJhbXMuYWR2ZXJ0aXNpbmcuY2xpZW50ID0gKCAgdGhpcy5pc0ZsYXNoRW5hYmxlZCA9PSB0cnVlICYmIHdpbmRvdy5qd3BsYXllci5kZWZhdWx0cy5wcmltYXJ5ID09ICdmbGFzaCcgICkgPyAndmFzdCcgOiAnZ29vZ2ltYSc7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmltYXJ5ID0gJ2h0bWw1JztcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAvLyBzZXQgdGhlIGFkY2xpZW50IHRvIGdvb2dpbWEgZm9yIG5vbiBkZXNrdG9wIGRldmljZXNcbiAgICAgICAgICAgIHRoaXMucGFyYW1zLmFkdmVydGlzaW5nLmNsaWVudCA9IHRoaXMuZGV2aWNlID09ICdkZXNrdG9wJyA/IHRoaXMucGFyYW1zLmFkdmVydGlzaW5nLmNsaWVudCA6ICdnb29naW1hJztcblxuICAgICAgICAgICAgLy8gc2V0dXAgdGhlIHBsYXllclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuc2V0dXAodGhpcy5wYXJhbXMpO1xuICAgICAgICB9XG5cbiAgICB9XG5cbi8vIGNoZWNrIGlmIGZsYXNoIGlzIGF2YWlsYWJsZSB0aGUgc2V0IHRoZSByaWdodCBwcmltYXJ5IGZvciB0aGF0XG4gICAgZGV0ZWN0Rmxhc2goKSB7XG5cbiAgICAgICAgdGhpcy5pc0ZsYXNoRW5hYmxlZCA9IGZsYXNoRGV0ZWN0b3IoKTtcblxuICAgICAgICAvLyBkcm9wIGEgY29uc29sZSBtZXNzYWdlIHdoZW4gZmxhc2ggaXMgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAodGhpcy5pc0ZsYXNoRW5hYmxlZCkge1xuICAgICAgICAgICAgdGhpcy5kZWJ1Z01lc3NhZ2UodGhpcy5tZXNzYWdlcy5mbGFzaERldGVjdGVkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZGVidWdNZXNzYWdlKHRoaXMubWVzc2FnZXMuZmxhc2hOb3REZXRlY3RlZCk7XG5cbiAgICAgICAgfVxuXG5cbiAgICAgICAgLy8gZmlyZSBldmVudCB3aGVuIGZsYXNoIG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKHRoaXMucHJpbWFyeSA9PT0gJ2ZsYXNoJyAmJiB0aGlzLmlzRmxhc2hFbmFibGVkID09PSBmYWxzZSkgdGhpcy5kaXNwYXRjaEV2ZW50KCdmYWxsYmFja3RvaHRtbDUnKTtcblxuICAgICAgICB0aGlzLnByaW1hcnkgPSAodGhpcy5pc0ZsYXNoRW5hYmxlZCkgPyAnZmxhc2gnIDogJ2h0bWw1JztcblxuICAgIH1cblxuICAgIC8vIHNlbGVjdCB0aGUgdmFzdCB0YWcgYmFzZWQgb24gdGhlIGFjdGl2ZSBwcmltYXJ5IHZhbHVlXG4gICAgc2VsZWN0VmFzdFRhZygpIHtcbiAgICAgICAgdGhpcy5BZHRhZyA9ICh0aGlzLnByaW1hcnkgPT09ICdmbGFzaCcgJiYgdGhpcy5BZFRhZ3NPYmouZmxhc2hUYWcgKSA/IHRoaXMuQWRUYWdzT2JqLmZsYXNoVGFnIDogdGhpcy5BZFRhZ3NPYmouaHRtbDVUYWc7XG5cbiAgICB9XG5cblxuICAgIGdldCBmbGFzaEZhbGxCYWNrKCkge1xuICAgICAgICByZXR1cm4gZmFsbGJhY2tzLmRlZmF1bHQuZmxhc2hGYWxsQmFjaztcbiAgICB9XG5cbiAgICBnZXQgaHRtbDVmYWxsYmFjaygpIHtcbiAgICAgICAgcmV0dXJuIGZhbGxiYWNrcy5kZWZhdWx0Lmh0bWw1ZmFsbGJhY2s7XG4gICAgfVxuXG4gICAgZ2V0IEFERXJyb3IoKSB7XG4gICAgICAgIHJldHVybiBsb2dnZXIuZGVmYXVsdC5BREVycm9yO1xuICAgIH1cblxuICAgIGdldCBkZWJ1Z01lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiBsb2dnZXIuZGVmYXVsdC5kZWJ1Z01lc3NhZ2U7XG4gICAgfVxuXG4gICAgZ2V0IGVycm9ySGFuZGxlcigpIHtcbiAgICAgICAgcmV0dXJuIGxvZ2dlci5kZWZhdWx0LmVycm9ySGFuZGxlcjtcbiAgICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgUGNoVmlkZW9QbGF5ZXI7Il0sIm5hbWVzIjpbIkV2ZW50RGlzcGF0Y2hlciIsImV2ZW50U3RhY2siLCJmaXJlZFN0YWNrIiwidHlwZSIsImNhbGxiYWNrIiwic3BsaXQiLCJmaWx0ZXIiLCJpdGVtIiwiZm9yRWFjaCIsImV2ZW50TmFtZSIsIl90aGlzIiwicHVzaCIsInNwbGljZSIsInRoaXMiLCJpbmRleE9mIiwiZGF0YSIsImV2dFN0YWNrIiwibGVuZ3RoIiwiZXZ0IiwiY2FsbCIsImRpc3BhdGNoRXZlbnQiLCJBdHRhY2hFdmVudHMiLCJwbGF5ZXIiLCJvbiIsImV2ZW50IiwiZGlzcGF0Y2hPbmNlIiwiZGVidWdNZXNzYWdlIiwiX3RoaXMyIiwibWVzc2FnZXMiLCJhZEltcHJlc3Npb24iLCJwcmltYXJ5IiwicmVtYWluaW5nIiwiTWF0aCIsInJvdW5kIiwiZHVyYXRpb24iLCJwb3NpdGlvbiIsIkFERXJyb3IiLCJjb21wbGV0ZUZsYWciLCJhZENvbXBsZXRlIiwiZmFsbEJhY2tFbmFibGVkIiwiZmFsbEJhY2tGbGFnIiwiZmFsbEJhY2tUaW1lIiwiRGF0ZSIsIm5vdyIsIkhUTUxGaXJzdCIsImRldGVjdEZsYXNoIiwiaXNGbGFzaEVuYWJsZWQiLCJmbGFzaEZhbGxCYWNrIiwiaHRtbDVmYWxsYmFjayIsIm5vQWQiLCJmb3JjZUFkQ29tcGxldGUiLCJmbGFzaERldGVjdG9yIiwicGx1Z2lucyIsIndpbmRvdyIsIm5hdmlnYXRvciIsImkiLCJ0ZXN0IiwibmFtZSIsInVwZGF0ZUFEdGFnIiwidGFnIiwiQUR0YWciLCJyZXBsYWNlIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwibG9jYXRpb24iLCJocmVmIiwiUENIVVNFUiIsInVybFBhcmFtT2JqIiwiYSIsImFnZSIsImciLCJnZW5kZXIiLCJhciIsImFnZVJhbmdlIiwic2VnIiwic2VnbWVudHMiLCJnbXQiLCJsZXZlbCIsInJlZ2xpc3QiLCJqb2luIiwidXJsUGFyYW1zIiwiZmFsbEJhY2t0b0ZsYXNoIiwic2VsZWN0VmFzdFRhZyIsInBhcmFtcyIsImFkdmVydGlzaW5nIiwiQWR0YWciLCJzZXR1cFBhcmFtcyIsInNldHVwUGxheWVyUGFyYW1zIiwiYXR0YWNoRXZlbnRzIiwiaHRtbEZhbGxCYWNrIiwibXNnIiwiZGVidWdNb2RlIiwibG9nIiwiZXJyIiwiZXJyb3JGbGFnIiwiZmxhc2hBZEVtdHB5IiwiaHRtbEFERW1wdHkiLCJjb250YWluZXIiLCJBZFRhZ3NPYmoiLCJhZFRhZ3MiLCJqd3BsYXllciIsImRlZmF1bHRzIiwiY2xpZW50IiwiYWRQbHVnaW4iLCJmYWxsQmFja1ZpZGVvIiwidnBhaWRNb2RlIiwidnBhaWRtb2RlIiwidXBkYXRlREZQdGFnIiwidXBkYXRlVGFnIiwiYWRUZWNoIiwiZmlyc3RUYWciLCJzZWNvbmRUYWciLCJodG1sRmlyc3QiLCJoYXNGbGFzaFRhZyIsIm11dGUiLCJkZXZpY2UiLCJ0b0xvd2VyQ2FzZSIsImZsYXNoVGFnIiwiaHRtbDVUYWciLCJzZXRJbml0aWFsU3RhdGUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZXJyb3JIYW5kbGVyIiwiY29udGFpbmVyRXJyb3IiLCJqd3BsYXllclNjcmlwdEVycm9yIiwiYmFiZWxIZWxwZXJzLnR5cGVvZiIsImZpbGUiLCJzZXR1cCIsImZsYXNoRGV0ZWN0ZWQiLCJmbGFzaE5vdERldGVjdGVkIiwiZmFsbGJhY2tzIiwibG9nZ2VyIl0sIm1hcHBpbmdzIjoiOHJDQVVxQkEseUNBR1JDLG1CQUlBQyxtREFVTkMsRUFBTUMsb0JBQ2UsaUJBQVRELElBSU9BLEVBQUtFLE1BQU0sS0FBS0MsT0FBTyxrQkFBZ0IsSUFBUkMsSUFHdkNDLFFBQVEsU0FBQ0MsR0FFWSxtQkFBWkwsTUFFRkgsV0FBV1EsR0FBZUMsRUFBS1QsV0FBV1EsU0FDMUNSLFdBQVdRLEdBQVdFLEtBQU1QLE9BSXRDLCtCQVFQRCxRQUNtQixJQUFSQSxPQUNGRixtQkFFQUEsV0FBV1csT0FBT0MsS0FBS1osV0FBV2EsUUFBUVgsR0FBTSx5Q0FXL0NBLGNBQU1ZLDREQUNaQyxFQUFXSCxLQUFLWixXQUFXRSxPQUUzQmEsRUFBU0MsY0FDSmYsV0FBV0MsSUFBUSxJQUNmSyxRQUFRLFNBQUNVLEtBQ1ZDLE9BQVdKLDJDQVlkWixFQUFNWSxlQUNxQixJQUF6QkYsS0FBS1gsV0FBV0MsVUFDbEJpQixjQUFjakIsRUFBTVksSUFDbEIs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
